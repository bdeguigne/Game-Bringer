{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/bdeguigne/Downloads/backup onedrive de mort/Game Bringer/src/components/Advanced Search/AdvancedSearch.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport styled from \"styled-components\";\nimport { appColors } from \"../../utils/styles\";\nimport { InputBase } from \"@material-ui/core\";\nimport { setRouteIndex, setIsCorrectIds, setActivatedFiltersAction } from \"../../redux/actions/UIActions\";\nimport { search } from '../../redux/actions/filtersActions';\nimport TermChip from \"./ChipFilters\";\nimport { RouteIndex } from \"../../redux/constants/uiConstants\";\nimport SearchResultCard from \"./SearchResultCard\";\nimport { Padding } from '../../utils/styles';\nimport HandleFilters from './HandleFilters';\nimport { useLocation, withRouter } from \"react-router-dom\";\nimport { generateParams, getFiltersWithQuery, findValueFromQuery, replace } from './filters';\nimport { compose } from 'redux';\nconst SearchContainer = styled.div`\n  width: 100%;\n  height: 160px;\n  display: flex;\n  align-items: center;\n`;\n_c = SearchContainer;\nconst SearchBar = styled.div`\n  border: 1px solid ${appColors.secondaryDarker};\n  border-radius: 16px;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background-color : ${appColors.backgroundContrast};\n  box-shadow: 0px 0px 12px 3px rgba(0, 0, 0, 0.25), inset 0px 0px 8px #6D5DD3;\n`;\n_c2 = SearchBar;\nconst SearchInput = styled(InputBase)`\n  width: 100%;\n  background: transparent;\n  font-size: 34px !important;\n  font-weight: 600 !important;\n  color: white;\n  outline: none;\n  padding: 4px 12px;\n`;\n_c3 = SearchInput;\nconst SearchButtonContainer = styled.div`\n    height: 65px;\n    width: 70px;\n    justify-content: center;\n    display: flex;\n    align-items: center;\n    background-color: ${appColors.secondary} !important;\n    border-radius: 16px !important;\n    cursor: pointer;\n    box-shadow: -1px 0px 18px -5px rgba(255, 255, 255, 0.25);\n`;\n_c4 = SearchButtonContainer;\nconst SearchIcon = styled.span`\n    font-size: 24px;\n`;\n_c5 = SearchIcon;\nconst Row = styled.div`\n    display: flex;\n    width: 100%;\n`;\n_c6 = Row;\nconst ResultContainer = styled.div`\n  /* margin-top: 24px; */\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n`;\n_c7 = ResultContainer;\n\nconst AdvancedSearch = props => {\n  _s();\n\n  let location = useLocation();\n  const [queryFilters, setQueryFilters] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [searchValue, setSearchValue] = useState(\"\");\n  const [activatedFilters, setActivatedFilters] = useState({});\n  const [refresh, setRefresh] = useState(0);\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    setQueryFilters(getFiltersWithQuery(queryParams));\n\n    if (searchValue === \"\") {\n      setSearchValue(findValueFromQuery(queryFilters, \"term\"));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [location]);\n  useEffect(() => {\n    props.setRouteIndex(RouteIndex.SEARCH);\n  }, [props]);\n\n  const onFiltersChange = activatedFilters => {\n    console.log(\"ON FILTERS CHANGE\", activatedFilters);\n    setRefresh(prev => prev + 1);\n    setActivatedFilters(activatedFilters);\n    props.setActivatedFiltersAction(activatedFilters);\n    props.search(activatedFilters.front);\n    const url = props.match.path + \"?\" + generateParams(activatedFilters.front);\n    props.history.replace(url);\n  };\n\n  const searchInputClick = () => {\n    setSearchTerm(searchValue);\n  }; //Handle \"Enter\" Key\n\n\n  const onKeyPressed = evt => {\n    if (evt.key === \"Enter\") {\n      searchInputClick();\n      evt.preventDefault();\n    }\n  };\n\n  useEffect(() => {\n    if (props.correctIds.length > 0) {\n      const alreadyCorrectIds = [];\n      Object.keys(activatedFilters.chip).forEach(filterKey => {\n        props.correctIds.forEach(correctData => {\n          if (filterKey === correctData.name) {\n            let isCompany = false;\n\n            if (correctData.name === \"companies\") {\n              isCompany = true;\n            }\n\n            let filterValue = activatedFilters.chip[filterKey].split(\",\");\n            filterValue.forEach(value => {\n              correctData.result.forEach(data => {\n                const id = isCompany ? data.company.id : data.id;\n\n                if (!alreadyCorrectIds.includes(id) && id === parseInt(value)) {\n                  isCompany ? filterValue.push(data.company.name) : filterValue.push(data.name);\n                  filterValue = filterValue.filter(item => parseInt(item) !== id);\n                  alreadyCorrectIds.push(id);\n                }\n              });\n            });\n            const correctFilters = filterValue.join(\",\");\n            activatedFilters.chip = replace(activatedFilters.chip, filterKey, correctFilters);\n          }\n        });\n      });\n      console.log(\"EEEND\", activatedFilters);\n      props.setIsCorrectIds(true);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [props.correctIds, activatedFilters]); // useEffect(() => {\n  //     console.log(\"IN REACT\", props.searchResult)\n  // }, [props.searchResult])\n\n  return /*#__PURE__*/_jsxDEV(Padding, {\n    children: [/*#__PURE__*/_jsxDEV(SearchContainer, {\n      children: /*#__PURE__*/_jsxDEV(SearchBar, {\n        children: [/*#__PURE__*/_jsxDEV(SearchInput, {\n          placeholder: \"Search and discover new games\",\n          onChange: evt => setSearchValue(evt.target.value),\n          value: searchValue,\n          onKeyPress: onKeyPressed\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(SearchButtonContainer, {\n          onClick: searchInputClick,\n          children: /*#__PURE__*/_jsxDEV(SearchIcon, {\n            className: \"icon-search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(TermChip, {\n      activatedFilters: activatedFilters,\n      onChangeFilters: onFiltersChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(ResultContainer, {\n        children: props.searchResult && props.searchResult.map((res, i) => {\n          var _res$company;\n\n          return /*#__PURE__*/_jsxDEV(SearchResultCard, {\n            game: res.name,\n            developer: (_res$company = res.company) === null || _res$company === void 0 ? void 0 : _res$company.name,\n            date: res.releaseDate,\n            platforms: res.platforms,\n            coverId: res.coverID,\n            rating: res.rating\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(HandleFilters, {\n        queryFilters: queryFilters,\n        onChange: onFiltersChange,\n        term: searchTerm,\n        refresh: refresh\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AdvancedSearch, \"ByuBAeRLxpZl5g3q1F0BpxG78z4=\", false, function () {\n  return [useLocation];\n});\n\n_c8 = AdvancedSearch;\nconst actionCreators = {\n  setRouteIndex,\n  search,\n  setIsCorrectIds,\n  setActivatedFiltersAction\n};\n\nfunction mapStateToProps(state) {\n  return {\n    searchResult: state.filtersReducer.searchResult,\n    correctIds: state.filtersReducer.correctIds\n  };\n}\n\nexport default compose(withRouter, connect(mapStateToProps, actionCreators))(AdvancedSearch);\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8;\n\n$RefreshReg$(_c, \"SearchContainer\");\n$RefreshReg$(_c2, \"SearchBar\");\n$RefreshReg$(_c3, \"SearchInput\");\n$RefreshReg$(_c4, \"SearchButtonContainer\");\n$RefreshReg$(_c5, \"SearchIcon\");\n$RefreshReg$(_c6, \"Row\");\n$RefreshReg$(_c7, \"ResultContainer\");\n$RefreshReg$(_c8, \"AdvancedSearch\");","map":{"version":3,"sources":["/Users/bdeguigne/Downloads/backup onedrive de mort/Game Bringer/src/components/Advanced Search/AdvancedSearch.js"],"names":["React","useEffect","useState","connect","styled","appColors","InputBase","setRouteIndex","setIsCorrectIds","setActivatedFiltersAction","search","TermChip","RouteIndex","SearchResultCard","Padding","HandleFilters","useLocation","withRouter","generateParams","getFiltersWithQuery","findValueFromQuery","replace","compose","SearchContainer","div","SearchBar","secondaryDarker","backgroundContrast","SearchInput","SearchButtonContainer","secondary","SearchIcon","span","Row","ResultContainer","AdvancedSearch","props","location","queryFilters","setQueryFilters","searchTerm","setSearchTerm","searchValue","setSearchValue","activatedFilters","setActivatedFilters","refresh","setRefresh","queryParams","URLSearchParams","SEARCH","onFiltersChange","console","log","prev","front","url","match","path","history","searchInputClick","onKeyPressed","evt","key","preventDefault","correctIds","length","alreadyCorrectIds","Object","keys","chip","forEach","filterKey","correctData","name","isCompany","filterValue","split","value","result","data","id","company","includes","parseInt","push","filter","item","correctFilters","join","target","searchResult","map","res","i","releaseDate","platforms","coverID","rating","actionCreators","mapStateToProps","state","filtersReducer"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport styled from \"styled-components\";\nimport { appColors } from \"../../utils/styles\";\nimport { InputBase } from \"@material-ui/core\";\nimport { setRouteIndex, setIsCorrectIds, setActivatedFiltersAction } from \"../../redux/actions/UIActions\";\nimport { search } from '../../redux/actions/filtersActions';\nimport TermChip from \"./ChipFilters\";\nimport { RouteIndex } from \"../../redux/constants/uiConstants\";\nimport SearchResultCard from \"./SearchResultCard\";\nimport { Padding } from '../../utils/styles';\nimport HandleFilters from './HandleFilters';\nimport { useLocation, withRouter } from \"react-router-dom\";\nimport { generateParams, getFiltersWithQuery, findValueFromQuery, replace } from './filters'\nimport { compose } from 'redux';\n\nconst SearchContainer = styled.div`\n  width: 100%;\n  height: 160px;\n  display: flex;\n  align-items: center;\n`\n\nconst SearchBar = styled.div`\n  border: 1px solid ${appColors.secondaryDarker};\n  border-radius: 16px;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background-color : ${appColors.backgroundContrast};\n  box-shadow: 0px 0px 12px 3px rgba(0, 0, 0, 0.25), inset 0px 0px 8px #6D5DD3;\n`\n\nconst SearchInput = styled(InputBase)`\n  width: 100%;\n  background: transparent;\n  font-size: 34px !important;\n  font-weight: 600 !important;\n  color: white;\n  outline: none;\n  padding: 4px 12px;\n`\n\nconst SearchButtonContainer = styled.div`\n    height: 65px;\n    width: 70px;\n    justify-content: center;\n    display: flex;\n    align-items: center;\n    background-color: ${appColors.secondary} !important;\n    border-radius: 16px !important;\n    cursor: pointer;\n    box-shadow: -1px 0px 18px -5px rgba(255, 255, 255, 0.25);\n`\n\nconst SearchIcon = styled.span`\n    font-size: 24px;\n`\n\nconst Row = styled.div`\n    display: flex;\n    width: 100%;\n`\n\nconst ResultContainer = styled.div`\n  /* margin-top: 24px; */\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n`\n\nconst AdvancedSearch = (props) => {\n    let location = useLocation();\n    const [queryFilters, setQueryFilters] = useState(null);\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const [searchValue, setSearchValue] = useState(\"\");\n    const [activatedFilters, setActivatedFilters] = useState({})\n    const [refresh, setRefresh] = useState(0);\n\n    useEffect(() => {\n        const queryParams = new URLSearchParams(location.search);\n        setQueryFilters(getFiltersWithQuery(queryParams));\n\n        if (searchValue === \"\") {\n            setSearchValue(findValueFromQuery(queryFilters, \"term\"));\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [location])\n\n    useEffect(() => {\n        props.setRouteIndex(RouteIndex.SEARCH);\n    }, [props]);\n\n    const onFiltersChange = (activatedFilters) => {\n        console.log(\"ON FILTERS CHANGE\", activatedFilters);\n        setRefresh(prev => prev + 1)\n        \n        setActivatedFilters(activatedFilters);\n        props.setActivatedFiltersAction(activatedFilters);\n        props.search(activatedFilters.front);\n\n        const url = props.match.path + \"?\" + generateParams(activatedFilters.front);\n\n        props.history.replace(url);\n    }\n\n    const searchInputClick = () => {\n        setSearchTerm(searchValue);\n    }\n\n    //Handle \"Enter\" Key\n    const onKeyPressed = (evt) => {\n        if (evt.key === \"Enter\") {\n            searchInputClick()\n            evt.preventDefault();\n        }\n    }\n\n    useEffect(() => {\n        if (props.correctIds.length > 0) {\n            const alreadyCorrectIds = [];\n\n            Object.keys(activatedFilters.chip).forEach(filterKey => {\n                props.correctIds.forEach(correctData => {\n                    if (filterKey === correctData.name) {\n                        let isCompany = false;\n\n                        if (correctData.name === \"companies\") {\n                            isCompany = true;\n                        }\n\n                        let filterValue = activatedFilters.chip[filterKey].split(\",\");\n\n                        filterValue.forEach(value => {\n                            correctData.result.forEach(data => {\n                                const id = isCompany ? data.company.id : data.id;\n                                if (!alreadyCorrectIds.includes(id) && id === parseInt(value)) {\n                                    isCompany ? filterValue.push(data.company.name) : filterValue.push(data.name)\n                                    filterValue = filterValue.filter(item => parseInt(item) !== id)\n                                    alreadyCorrectIds.push(id);\n                                }\n                            })\n                        })\n\n                        const correctFilters = filterValue.join(\",\");\n                        \n\n                        activatedFilters.chip = replace(activatedFilters.chip, filterKey, correctFilters);\n\n                    }\n                })\n            })\n            console.log(\"EEEND\", activatedFilters)\n            props.setIsCorrectIds(true);\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.correctIds, activatedFilters])\n\n    // useEffect(() => {\n    //     console.log(\"IN REACT\", props.searchResult)\n    // }, [props.searchResult])\n\n    return (\n        <Padding>\n            <SearchContainer>\n                <SearchBar>\n                    <SearchInput\n                        placeholder={\"Search and discover new games\"}\n                        onChange={(evt) => setSearchValue(evt.target.value)}\n                        value={searchValue}\n                        onKeyPress={onKeyPressed}\n                    />\n                    <SearchButtonContainer onClick={searchInputClick}>\n                        <SearchIcon className=\"icon-search\" />\n                    </SearchButtonContainer>\n                </SearchBar>\n            </SearchContainer>\n            <TermChip activatedFilters={activatedFilters} onChangeFilters={onFiltersChange}/>\n            <Row>\n                <ResultContainer>\n                    {props.searchResult && props.searchResult.map((res, i) => {\n                        return (\n                            <SearchResultCard\n                                key={i}\n                                game={res.name}\n                                developer={res.company?.name}\n                                date={res.releaseDate}\n                                platforms={res.platforms}\n                                coverId={res.coverID}\n                                rating={res.rating}\n                            />\n                        )\n                    })}\n                </ResultContainer>\n                <HandleFilters queryFilters={queryFilters} onChange={onFiltersChange} term={searchTerm} refresh={refresh} />\n            </Row>\n        </Padding>\n    );\n}\n\nconst actionCreators = {\n    setRouteIndex,\n    search,\n    setIsCorrectIds,\n    setActivatedFiltersAction\n}\n\nfunction mapStateToProps(state) {\n    return {\n        searchResult: state.filtersReducer.searchResult,\n        correctIds: state.filtersReducer.correctIds\n    };\n}\n\nexport default compose(\n    withRouter,\n    connect(\n        mapStateToProps,\n        actionCreators\n    )\n)(AdvancedSearch);\n"]},"metadata":{},"sourceType":"module"}